/*! For license information please see big-axios.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("axios")):"function"==typeof define&&define.amd?define("big-axios",["axios"],t):"object"==typeof exports?exports["big-axios"]=t(require("axios")):e.BigAxios=t(e.axios)}(self,(e=>(()=>{"use strict";var t={300:t=>{t.exports=e}},s={};function o(e){var r=s[e];if(void 0!==r)return r.exports;var n=s[e]={exports:{}};return t[e](n,n.exports,o),n.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{o.r(r),o.d(r,{default:()=>p});var e=o(300),t=o.n(e);const s={400:{msg:"错误的请求"},401:{msg:"验证失败"},403:{msg:"服务器拒绝访问，请检查操作是否合法"},404:{msg:"请求地址不存在"},405:{msg:"您没有权限进行此操作"},406:{msg:"请您保证内容完整后提交"},409:{msg:"内容已存在"},429:{msg:"请求过于频繁，请稍后再试"},413:{msg:"请求实体过大"},414:{msg:"请求URI过长"},415:{msg:"不支持的媒体类型"},500:{msg:"服务器内部错误，请联系管理员"},501:{msg:""},502:{msg:"网关错误，请检查您的网络"},503:{msg:"服务器维护中,请稍后重试"},504:{msg:"网关连接超时，请检查您的网络"}},n=class{constructor(e){this.serviceApiErrorMsgs={"-9999":{msg:"发起网络请求失败"},...e}}getExceptionMsg=function(e,t){const o=this.serviceApiErrorMsgs[e+""]??s[e+""];return o?(o.callback&&o.callback(),t||o.msg):t||"未知错误"}},i=[];let a=new AbortController,c=[];const p=new class{http=t().create();interceptorIds=[];exception=null;get axiosHttp(){return this.http}get builtInInterceptorIds(){return this.interceptorIds}create(e,s,o){this.exception=new n(e);const r={loginPath:"/login",successfulCodes:[200,0,"200"],responseDataObjectKey:"data",...o};return this.url="",this.data={},this.http=t().create(s),this.interceptorIds.push(this.http.interceptors.request.use((e=>(e.signal=a.signal,e)),(e=>({...e,message:this.exception.getExceptionMsg(-9999)})))),this.interceptorIds.push(this.http.interceptors.response.use((e=>{if(r.successfulCodes.includes(e.data.code)||"application/octet-stream"===e.headers["content-type"]||"image/Jpeg"===e.headers["content-type"])return Promise.resolve(e);{const t={...e,errorUrl:e.request.responseURL,message:this.exception.getExceptionMsg(e.data.code,e.data.errMsg||e.data.message||e.data.msg)};return Promise.reject(t)}}),(e=>{let t="";e.response?401===e.response.status?(i.push(e.response),1===i.length&&(t=this.exception.getExceptionMsg(e.response.status,e.response.data.message||e.response.data.errMsg||"登录信息已过期"),location.href.includes(r.loginPath)||(location.href=r.loginPath))):t=this.exception.getExceptionMsg(e.response.status,e.response.data.errMsg||e.response.data.message||""):t=this.exception.getExceptionMsg(504,"");const s={...e,config:e.config,data:e.response.data,errorUrl:e.config?e.config.url:"",isCanceled:"canceled"===e.message,message:t};return Promise.reject(s)}))),this.interceptorIds.push(this.http.interceptors.response.use((e=>r.successfulCodes.includes(e.data.code)&&null===e.data[r.responseDataObjectKey]&&Object.hasOwn(r,"defaultResponseData")?Promise.resolve({...e,data:{...e.data,[r.responseDataObjectKey]:r.defaultResponseData}}):e),(e=>e))),this}interceptors={request:{...this.http.interceptors.request,use:(e,t,s={synchronous:!1,runWhen:null})=>this.http.interceptors.request.use(e,t,s)},response:{...this.http.interceptors.response,use:(e,t,s={synchronous:!1,runWhen:null})=>this.http.interceptors.response.use(e,t,s)}};ajax(e,t={},{type:s="GET",options:o={}}={}){switch(this.url=e,this.type=s.toLocaleUpperCase().trim(),this.data="GET"===this.type?{params:t}:t,this.options=o,this.type){case"GET":return new Promise(((e,t)=>{const s=Object.assign(this.data,this.options);this.http.get(this.url,s).then((t=>(Blob,e(t.data)))).catch((e=>(this.log(e),t(e))))}));case"POST":return new Promise(((e,t)=>{if(!this.url.includes("login")){const e=JSON.stringify(this.data);if(c.find((t=>t.url===this.url&&t.data===e)))return t({message:"请不要提交重复的数据"});c.push({url:this.url,data:e})}this.http.post(this.url,this.data,this.options).then((t=>(Blob,e(t.data)))).catch((e=>(c=c.filter((t=>t.url!==e.config.url||t.data!==e.config.data)),this.log(e),t(e))))}));case"PUT":return new Promise(((e,t)=>{this.http.put(this.url,this.data,this.options).then((t=>e(t.data))).catch((e=>(this.log(e),t(e))))}));case"DELETE":return new Promise(((e,t)=>{this.http.delete(this.url,this.options).then((t=>e(t.data))).catch((e=>(this.log(e),t(e))))}))}}get(e,t={},s={}){return this.ajax(e,t,{options:s})}post(e,t={},s={}){return this.ajax(e,t,{type:"POST",options:s})}put(e,t={},s={}){return this.ajax(e,t,{type:"PUT",options:s})}delete(e,t={}){return this.ajax(e,{},{type:"DELETE",options:t})}abort(){a.abort(),a=new AbortController}clearPostData(){c=[]}log(e){if("canceled"===e.message)return console.warn("尚未完成的 http 请求已取消: ",e.message);console.group("%c http 请求错误：","color:red;"),Object.keys(e).length>0?(console.log("%c地址：","font-family:PingFang SC, Microsoft YaHei;",e.errorUrl),console.log("%c方式：","font-family:PingFang SC, Microsoft YaHei;",e.config.method),console.log("%c参数：","font-family:PingFang SC, Microsoft YaHei;",e.config.params),console.log("%c结果：","font-family:PingFang SC, Microsoft YaHei;",e.data),console.log("%c详细信息：","font-family:PingFang SC, Microsoft YaHei;",e)):console.log("%c error:","font-family:PingFang SC, Microsoft YaHei;",e),console.groupEnd()}}})(),r})()));
//# sourceMappingURL=big-axios.min.map